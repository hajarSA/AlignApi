<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Advanced tutorial on the Alignment API</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta name="Contributor" content="Antoine Zimmermann" />
<link rel="stylesheet" type="text/css" href="../base.css" />
<link rel="stylesheet" type="text/css" href="../style.css" />
<script type="text/javascript">
<!--
function show(id) {
	var element = document.getElementById(id);
	element.style.display = "block";
}
function hide(id) {
	var element = document.getElementById(id);
	element.style.display = "none";
}
-->
</script>
<style type="text/css">
<!--
div.logic {
	padding-left: 5px;
	padding-right: 5px;
	margin-top: 10px;
	margin-bottom: 10px;
}
-->
</style>
</head>
<body style="background-color: #FFFFFF;">

<h1>Advanced tutorial on the Alignment <abbr title="Application Programming Interface">API</abbr> and server</h1>

<dl>
<dt>This version:</dt>
<dd>http://alignapi.gforge.inria.fr/tutorial2/</dd>
<dt>Author:</dt>
<dd><a href="http://exmo.inrialpes.fr/people/euzenat">J&eacute;r&ocirc;me Euzenat</a>, INRIA  &amp; LIG
</dd>
</dl>

<p style="border-top: 2px solid
	  #AAAAAA; padding-top: 15px; padding-bottom: 15px;">
Here is a more advanced   tutorial for the
alignment <abbr>API</abbr>. 
This tutorial will learn you to:
<ul>
<li>communicate the alignment server
through its REST web service API,</li>
<li>manipulate the Alignments with the Alignment API in Java,</li>
<li>perform OWL reasoning on alignmed ontologies and compose
  alignments.</li>
</ul>
This time, the tutorial is based on Java programming and using various
related APIs.
</p>
<p>

A more <a href="../tutorial/index.html">simple tutorial</a> as well as
  a small <a href="../tutorial/server.html">server tutorial</a> are also available.</p>
<p  style="border-top: 2px solid #AAAAAA;"><small>This tutorial has been designed for the Alignment API version 3.6.</small></p>
	
<h2>Preparation</h2>
	
<p>See the <a href="../tutorial/index.html">simple tutorial preparation part</a>.</p>
	
<h2>Data</h2>
	
<p>
We have two ontologies, to be found on the web, under which two half of the summerschool participants are described.
</p>
<p>
The goal is to have a unified view of these participants.
.</p>
	
<p>For that purpose, you have to develop a program in Java. This
  programme can be compiled by:
<div class="fragment">
$ javac -classpath ../../lib/align.jar:../../lib/procalign.jar:../../lib/jena/jena.jar:../../lib/jena/arq.jar:../../lib/iddl/iddl.jar:../../lib/pellet/pellet.jar MyApp.java
</div>
and run by:
<div class="fragment">
$ java -classpath .:../../lib/align.jar:../../lib/procalign.jar:../../lib/jena/jena.jar:../../lib/jena/arq.jar:../../lib/iddl/iddl.jar:../../lib/pellet/pellet.jar MyApp
</div>

</p>

<h2>Matching ontologies</h2>

<p>
This can be achieved:
<ul>
<li>by running programs either locally or from the alignment server</li>
<li>by finding an alignment from the web/server</li>
<li>by finding a chain of alignments from the web/server</li>
</ul>
</p>

<p>
Write a program that does try to find an alignment on the alignment
server <a href="http://aserv.inrialpes.fr">http://aserv.inrialpes.fr</a>
and, if none is found, compute one and store it on the server.
</p>


<p>A skeleton of program using the Alignment <abbr>API</abbr> is <a href="Skeleton.java">Skeleton.java</a>. It can be compiled by invoking:</p>


<div class="button">
  <input type="button" onclick="show('qu1')" value="Show solution 1"/>
  <input type="button" onclick="show('qu2')" value="Show solution 2"/>
  <input type="button" onclick="show('qu3')" value="Show solution 3"/>
  <input type="button" onclick="hide('qu1');hide('qu2');hide('qu3');" value="Hide solutions"/>
</div>
<div class="explain" id="qu1"><p>After introducing the main variables:</p>
<pre>
	URI onto1 = null;
	URI onto2 = null;
	String myId = "JETest";
	String u1 = "http://alignapi.gforge.inria.fr/tutorial/edu.mit.visus.bibtex.owl";
	String u2 = "http://alignapi.gforge.inria.fr/tutorial/myOnto.owl";
	String method = "fr.inrialpes.exmo.align.impl.method.StringDistAlignment";
	//	Parameters params = new BasicParameters();
</pre>
<p>The programme will invoke the alignment server and parse the result:</p>
<pre>
	// ***** First exercise: matching *****
	// Try to find an alignment between two ontologies from the server
	String match = getFromURLString( RESTServ+"find?onto1="+u1+"&onto2="+u2, true );
</pre>
</div>
<div class="explain" id="qu2"><p>This programs use a local simple matching
    algorithm (StringDistAlignment) for obtaining an alignment:</p>
<pre>




// Threshold at various thresholds
// Evaluate them against the references
// and choose the one with the best F-Measure
AlignmentParser aparser = new AlignmentParser(0);
Alignment reference = aparser.parse( "file://"+(new File ( "refalign.rdf" ) . getAbsolutePath()) );
Evaluator evaluator = new PRecEvaluator( reference, a1 );

double best = 0.;
Alignment result = null;
for ( int i = 0; i &lt;= 10 ; i = i+2 ){
	a1.cut( ((double)i)/10 );
	evaluator.eval( new BasicParameters() );
	System.err.println("Threshold "+(((double)i)/10)+" : "+((PRecEvaluator)evaluator).getFmeasure());
	if ( ((PRecEvaluator)evaluator).getFmeasure() &gt; best ) {
             result = (BasicAlignment)((BasicAlignment)a1).clone();
	     best = ((PRecEvaluator)evaluator).getFmeasure();
	}
}

// Displays it as SWRL Rules
PrintWriter writer = new PrintWriter (
                      new BufferedWriter(
	               new OutputStreamWriter( System.out, "UTF-8" )), true);
AlignmentVisitor renderer = new SWRLRendererVisitor(writer);
result.render(renderer);
writer.flush();
writer.close();
</pre></div>
<div class="explain" id="qu3"><p>The main piece of code in Skeleton.java is replaced by:</p>
<pre>
</pre>
</div>
<div class="logic">
<p><b>More work:</b> You can also have the matching algorithms run on
  the server instead of localy.</p>
</div>
<div class="button">
  <input type="button" onclick="show('qu4')" value="Show solution"/>
  <input type="button" onclick="hide('qu4');" value="Hide solution"/>
</div>
<div class="explain" id="qu4"><p>The main piece of code in Skeleton.java is replaced by:</p>
<pre>
</pre>
</div>

<h2>Manipulate the data</h2>

<p>
Again, this is either:
<ul>
<li>generating OWL axioms from the alignments and merge the ontologies</li>
<li>transforming data from one ontology to another</li>
</ul>
This can be done with the alignment API support.
</p>
<p>
Show how it can be done in both cases:
</p>
<div class="button">
  <input type="button" onclick="show('qu5')" value="Show solution 1"/>
  <input type="button" onclick="show('qu6')" value="Show solution 2"/>
  <input type="button" onclick="hide('qu5');hide('qu6');" value="Hide solutions"/>
</div>
<div class="explain" id="qu5"><p>The main piece of code in Skeleton.java is replaced by:</p>
<pre>
</pre>
</div>
<div class="explain" id="qu6"><p>The main piece of code in Skeleton.java is replaced by:</p>
<pre>
</pre>
</div>


<h2>Generate the answers</h2>

<p>
This can be done in two ways:
<ul>
<li>using SPARQL but I think that I already</li>
<li>using Pellet or something to answer these queries.</li>
</ul>
Indeed, I will go for the second one (too bad because the first one is nice).
</p>
<div class="button">
  <input type="button" onclick="show('qu7')" value="Show solution 1"/>
  <input type="button" onclick="show('qu8')" value="Show solution 2"/>
  <input type="button" onclick="hide('qu7');hide('qu8');" value="Hide solutions"/>
</div>
<div class="explain" id="qu7"><p>The main piece of code in Skeleton.java is replaced by:</p>
<pre>
</pre>
</div>
<div class="explain" id="qu8"><p>The main piece of code in Skeleton.java is replaced by:</p>
<pre>
</pre>
</div>
	
<p>Do you want to see a possible solution?</p>

<p>A full working solution is <a href="MyApp.java">MyApp.java</a>.</p>


<h2>Further exercises</h2>
	
<p>More info: <a href="http://alignapi.gforge.inria.fr">http://alignapi.gforge.inria.fr</a></p>

	
<h2>Acknowledgements</h2>
	
<p>The format of this tutorial has been shamelessly borrowed from Sean Bechhofer's <a href="http://owl.man.ac.uk/2005/07/sssw/"><acronym>OWL</acronym> tutorial</a>.</p>	

<hr />
<small>
<p style="text-align: center;">http://alignapi.gforge.inria.fr/tutorial2/</p>
</small>
<hr />
<p>$Id$</p>
</body>
</html>
